function read(e,o){var t="",s=e+"=";document.cookie.split("").length>0&&(offset=document.cookie.indexOf(s),-1!=offset&&(offset+=s.length,end=document.cookie.indexOf(";",offset),-1==end&&(end=document.cookie.split("").length),t=document.cookie.substring(offset,end)));for(var n=t.split("&"),a={},r=!1,l=0,c=n.length;l<c;l++){var d=n[l].split("=");""!=d[0]&&(a[d[0]]=d[1],r=!0)}return!!r&&a}!function(){function e(e,o){(new Image).src="https://statwww2.kugou.com/node/weblog/jsloger?key=img_https_list&sourceUrl="+t+"&imgurl="+e+"&msg="+o}function o(o){if(!o)return 0;if(~o.indexOf("https://"))return o;var t="";return[["https://imgessl.kugou.com",["http://imge.kugou.com","http://imgessl.kugou.com","http://singerimg.kugou.com","http://c0.kgimg.com","http://c1.kgimg.com","http://c2.kgimg.com","http://c3.kgimg.com","http://c4.kgimg.com","http://c5.kgimg.com","http://c6.kgimg.com","http://c7.kgimg.com","http://c8.kgimg.com","http://c9.kgimg.com"]],["https://webimg.kgimg.com",["http://webimg.bssdl.kugou.com"]],["https://mobileservicebssdl.kugou.com",["http://mobileservice.bssdl.kugou.com"]],["https://mwebbssdl.kugou.com",["http://mweb.bssdl.kugou.com"]],["https://schoolimgbssdl.kugou.com",["http://schoolimg.bssdl.kugou.com"]],["https://activitybssdl.kugou.com",["http://activity.bssdl.kugou.com"]],["https://adsfile.kugou.com",["http://adsfile.bssdlbig.kugou.com"]],["https://imgacsing.kugou.com",["http://img.acsing.kugou.com"]]].forEach(function(e){var s=e[1],n=e[0];s.forEach(function(e){~o.indexOf(e)&&(t=o.replace(e,n))})}),t||e(o,"转化https链接失败"),t||o}var t=window.location.href;"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):window.replaceHttpsImg=o}();var common_header={init:function(){var e=this;e.herderUI(),e.navUI(),e.inputUI()},islogined:function(){var e=read("KuGoo");return""!=e&&"undefined"!=e.toString()&&!1!==e},herderUI:function(){var _this=this,login_in=document.getElementById("login_in"),login_btn=document.getElementById("login_btn"),login_out=document.getElementById("login_out"),user_menu=document.getElementById("user_menu"),menuT=null;if(_this.islogined()){var kugouC=read("KuGoo"),user_name=kugouC.NickName.replace(/%/g,"\\"),user=eval("'"+user_name+"'"),uer_img=kugouC.Pic;$("#login_in").hide(),$(login_out).show(),-1!=uer_img.indexOf("http")?$(login_out).find(".user_img").attr("src",replaceHttpsImg(uer_img)):$(login_out).find(".user_img").attr("src",replaceHttpsImg("http://imge.kugou.com/kugouicon/165/"+uer_img.substr(0,8)+"/"+uer_img)),$(login_out).find(".user_name").html(user)}else $("#login_btn").on("click",function(e){$.ajax({url:"https://staticssl.kugou.com/common/js/min/popuplogin-min.js?"+Math.round((new Date).getTime()/1e3),dataType:"script",success:function(){UsLogin()}})});login_out.onmouseover=function(){user_menu.style.cssText="display:block;"},login_out.onmouseleave=function(){menuT=setTimeout(function(){user_menu.style.display="none"},300)},login_out.onclick=function(){window.open("http://www.kugou.com/newuc/user/uc/")},user_menu.onmouseover=function(){clearTimeout(menuT),user_menu.style.cssText="display:block;"},user_menu.onmouseleave=function(){user_menu.style.cssText="display:none"}},navUI:function(){var e=null,o=document.getElementById("more"),t=document.getElementById("showMore"),s=document.getElementById("secondMenu");t.onclick=function(){return!1},o.onmouseover=function(){this.setAttribute("class","more hover"),t.setAttribute("class","icon icon-nav6"),s.style.cssText="display:block;"},o.onmouseleave=function(){this.setAttribute("class","more"),t.setAttribute("class","icon icon-nav6"),e=setTimeout(function(){s.style.display="none"},300)},s.onmouseover=function(){clearTimeout(e),o.setAttribute("class","more hover"),t.setAttribute("class","icon icon-nav6"),s.style.cssText="display:block;"},s.onmouseleave=function(){o.setAttribute("class","more"),t.setAttribute("class","icon icon-nav6"),s.style.cssText="display:none"}},delHtmlTag:function(e){return e.replace(/<[^>]+>/g,"")},htmlEncode:function(e){var o="";return 0==e.length?o:(o=o.replace(/<[^>]+>/g,""),o=e.replace(/\</g,"&lt;"),o=o.replace(/\>/g,"&gt;"),o=o.replace(/\'/g,"&#39;"),o=o.replace(/\"/g,"&quot;"),o=o.replace(/ /g,"&nbsp;"))},inputUI:function(){var e=this,o=$(".searh_btn"),t=$(".top_search_histroy"),s=$(".top_search_recommend"),n=$(".top_search .search_input input"),a=null,r=1,l=2,c=!1;t.on("click",".clear_histroy",function(){localStorage.s_keyword="",t.find(".history_song_list").empty(),t.removeClass("show").addClass("hide")}),e.nofouce(function(o){c=!0,$.isEmptyObject(o)||void 0===o||""==o||0==o.length||"undefined"==o[0]||"undefined"==o[0].keyword||(e.hasPlaceholder()?n.attr("placeholder",o[0].keyword):n.val(o[0].keyword))}),o.on("click",function(){var o=(n.attr("data"),n.val().replace(/(^\s+)|(\s+$)/g,""));""==o&&(o=n.attr("placeholder")||""),e.keywordStorge(o),location.replace("https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord="+encodeURIComponent(o))}),n.on("keydown",function(e){var o=n.val().replace(/(^\s+)|(\s+$)/g,""),a=$(".top_search_histroy dd"),c=$(".top_search_recommend dl.recommend_song_list dd"),d=$(".top_search_recommend dl.recommend_mv_list dd"),i=$(".top_search_histroy dd.hover").index(),m=$(".top_search_recommend .recommend_song_list dd.hover").index(),h=$(".top_search_recommend .recommend_mv_list dd.hover").index();if(13===e.keyCode){var o=(n.attr("data"),n.val().replace(/(^\s+)|(\s+$)/g,""));location.replace("https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord="+encodeURIComponent(o))}else 38==e.keyCode?(l=-1!=m?1:2,t.hasClass("show")?i+1==0?a.eq(a.length-1).addClass("hover").siblings("dd").removeClass("hover"):a.eq(i-1).addClass("hover").siblings("dd").removeClass("hover"):s.hasClass("show")&&(0==d.length&&0!=c.length&&(l=1,m+1==0?(l=1,c.removeClass("hover"),c.eq(c.length-1).addClass("hover")):(l=1,c.removeClass("hover"),c.eq(m-1).addClass("hover"))),0==c.length&&0!=d.length&&(l=2,h+1==0?(c.removeClass("hover"),d.eq(d.length-1).addClass("hover")):(d.removeClass("hover"),d.eq(h-1).addClass("hover"))),0!=c.length&&0!=d.length&&(1==l?0==m?(l=2,c.removeClass("hover"),d.eq(d.length-1).addClass("hover")):(c.removeClass("hover"),c.eq(m-1).addClass("hover")):h+1==0?(c.removeClass("hover"),d.eq(d.length-1).addClass("hover")):0==h?(l=1,d.removeClass("hover"),c.eq(c.length-1).addClass("hover")):(d.removeClass("hover"),d.eq(h-1).addClass("hover")))),t.hasClass("show")?n.val($(".search_histroy dd.hover").attr("title")):s.hasClass("show")&&(1==l?n.val($(".top_search_recommend .recommend_song_list dd.hover").attr("title")).attr("data","song"):n.val($(".top_search_recommend .recommend_mv_list dd.hover").attr("title")).attr("data","mv"))):40==e.keyCode&&(t.hasClass("show")?i+1==a.length?a.eq(0).addClass("hover").siblings("dd").removeClass("hover"):a.eq(i+1).addClass("hover").siblings("dd").removeClass("hover"):s.hasClass("show")&&(0==d.length&&0!=c.length&&(r=1,m+1==c.length?(c.removeClass("hover"),c.eq(0).addClass("hover")):(c.removeClass("hover"),c.eq(m+1).addClass("hover"))),0==c.length&&0!=d.length&&(r=2,h+1==c.length?(d.removeClass("hover"),d.eq(0).addClass("hover")):(d.removeClass("hover"),d.eq(h+1).addClass("hover"))),0!=c.length&&0!=d.length&&(1==r?m+1==0?(d.removeClass("hover"),c.eq(0).addClass("hover")):m+1==c.length?(r=2,c.removeClass("hover"),d.eq(0).addClass("hover")):(c.removeClass("hover"),c.eq(m+1).addClass("hover")):h+1==d.length?(r=1,d.removeClass("hover"),c.eq(0).addClass("hover")):(d.removeClass("hover"),d.eq(h+1).addClass("hover")))),t.hasClass("show")?n.val($(".search_histroy dd.hover").attr("title")):s.hasClass("show")&&(1==r?n.val($(".top_search_recommend .recommend_song_list dd.hover").attr("title")).attr("data","song"):n.val($(".top_search_recommend .recommend_mv_list dd.hover").attr("title")).attr("data","mv")))}).on("click",function(){c=!1,e.displayTip()}).on("textchange",function(){c||e.displayTip()}).on("blur",function(){a=setTimeout(function(){t.hasClass("noData")||t.addClass("hide").removeClass("show"),s.addClass("hide").removeClass("show")},400)}),t.mouseover(function(){clearTimeout(a),t.removeClass("hide").addClass("show")}),t.on("mousedown","dd",function(){var e=$(this).text();return n.val(e),location.replace("https://www.kugou.com/yy/html/search.html#searchType=song&searchKeyWord="+encodeURIComponent(e)),t.removeClass("show").addClass("hide"),!1}),s.mouseover(function(){clearTimeout(a),t.removeClass("hide").addClass("show")}),$(".top_search_recommend").on("mousedown","dd",function(o){o.stopPropagation(),o.preventDefault();var t=$(this).text();return n.val(t),e.keywordStorge(t),location.replace("https://www.kugou.com/yy/html/search.html#searchType="+$(this).attr("data-type")+"&searchKeyWord="+encodeURIComponent(t)),s.removeClass("show").addClass("hide"),!1})},nofouce:function(e){jQuery.support.cors=!0,$.ajax({type:"GET",url:"https://searchrecommend.kugou.com/v1/word_nofocus?platform=pc",dataType:"jsonp",success:function(o){e(1==o.status?o.data:"")},error:function(o){e("")}})},displayTip:function(){var e=this,o=$(".top_search_histroy"),t=$(".top_search_recommend"),s=$(".top_search .search_input input"),n=null;""!=s.val()?(o.addClass("hide").removeClass("show").hide(),clearTimeout(n),n=setTimeout(function(){e.wordRecommend({keyword:s.val(),callback:function(e){""!=e&&t.html(e).addClass("show").removeClass("hide").show()}})},10)):(t.addClass("hide").removeClass("show").hide(),e.historyHtml(function(e){""!=e?o.html(e).addClass("show").removeClass("hide").show():o.addClass("noData")}))},wordRecommend:function(e){var o={keyword:"",MusicTipCount:5,MVTipCount:2,albumcount:2},t=this,s=$.extend(o,e);$.ajax({type:"GET",url:"https://searchtip.kugou.com/getSearchTip?MusicTipCount=5&MVTipCount=2&albumcount=2&keyword="+encodeURIComponent(s.keyword),crossDomain:!0,dataType:"jsonp",success:function(o){if(1==o.status){if(o.data){var n=t.RecommendHtml(o.data,s.keyword);e.callback(n)}}else e.callback("")},error:function(o){e.callback("")}})},RecommendHtml:function(wordData,keyword){var _this=this;try{var recommendSongstr="<dl class='recommend_song_list recommend_list'>",recommendMvstr="<h4><span class='icon_arrow'></span>MV</h2><dl class='recommend_mv_list recommend_list'>",songData=null,mvData=null;if(wordData[0]&&(songData=wordData[0].RecordDatas),wordData[1]&&(mvData=wordData[1].RecordDatas),0==songData.length)recommendSongstr="";else{for(var i=0,Songlen=songData.length;i<Songlen;i++){var matchText="/"+keyword+"/",textem=songData[i].HintInfo.replace(eval(matchText),"<em>"+keyword+"</em>");recommendSongstr+="<dd data-type='song' title='"+_this.htmlEncode(songData[i].HintInfo)+"'>"+textem+"</dd>"}recommendSongstr+="</dl>"}if(0==mvData.length)return recommendSongstr;for(var j=0,Mvlen=mvData.length;j<Mvlen;j++){var matchText="/"+keyword+"/",textem=mvData[j].HintInfo.replace(eval(matchText),"<em>"+keyword+"</em>");recommendMvstr+="<dd data-type='mv' title='"+_this.htmlEncode(mvData[j].HintInfo)+"'>"+textem+"</dd>"}return recommendMvstr+="</dl>",recommendSongstr+recommendMvstr}catch(e){}},historyHtml:function(e){var o,t=this;if(""!=localStorage.s_keyword&&void 0!==localStorage.s_keyword&&(o=localStorage.s_keyword.split("|").reverse()),void 0!==o)if(0==o.length)e("");else{for(var s="<dl class='history_song_list'>",n=0,a=o.length;n<a;n++)s+="<dd>"+t.htmlEncode(decodeURI(o[n]))+"</dd>";s+="</dl><dl class='clear_histroy'><dt>清空历史记录</dt></dl>",e(s)}},hasPlaceholder:function(){return"placeholder"in document.createElement("input")},keywordStorge:function(e){if(""!=(e=e.replace(/(^\s+)|(\s+$)/g,""))){var o,t,s,n=[],a=!1;for(""!=localStorage.s_keyword&&void 0!==localStorage.s_keyword&&(n=localStorage.s_keyword.split("|")),o=0,t=n.length;o<t;o++)n[o]==encodeURI(e)&&(a=!0,s=o);a&&n.splice(s,1),n.length>=5&&(n=n.slice(n.length-4,n.length)),n.push(encodeURI(e)),localStorage.s_keyword=n.join("|")}},unique:function(e){for(var o=[],t={},s=0;s<e.length;s++)t[e[s]]||(t[e[s]]=!0,o.push(e[s]));return o}};$(document).ready(function(){$.jStorage&&$.jStorage.set("playdata",null),common_header.init()});